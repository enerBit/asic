name: Publish Python ðŸ distributions ðŸ“¦ to PyPI and TestPyPI

on: push

jobs:
  build-n-publish:
    name: Build and publish Python ðŸ distributions ðŸ“¦ to PyPI and TestPyPI
    runs-on: ubuntu-latest

  steps:
  - uses: actions/checkout@master
  - name: Set up Python 3.10
    uses: actions/setup-python@v3
    with:
      python-version: "3.10"
      
      
    - script: |
        python -m pip install --upgrade setuptools wheel
      displayName: 'Install build tools'

    - script: |
        python setup.py sdist bdist_wheel
      displayName: 'Build and wheel'      
      
  - name: Install build tools
    run: >-
      python -m
      pip install
      --upgrade
      setuptools wheel
  - name: Build and wheel
    run: >-
      python
      setup.py
      sdist
      bdist_wheel

  - name: Publish distribution ðŸ“¦ to Test PyPI
    uses: pypa/gh-action-pypi-publish@release/v1
    with:
      password: ${{ secrets.TEST_PYPI_API_TOKEN }}
      repository_url: https://test.pypi.org/legacy/
#   - name: Publish distribution ðŸ“¦ to PyPI
#     if: startsWith(github.ref, 'refs/tags')
#     uses: pypa/gh-action-pypi-publish@release/v1
#     with:
#       password: ${{ secrets.PYPI_API_TOKEN }}
